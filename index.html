<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Almacén Offline</title>
    <meta name="description" content="PWA base para un almacén que funciona sin conexión." />
    <meta name="theme-color" content="#0ea5e9" />
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="Almacén" />
  <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'%3E%3Crect width='192' height='192' rx='32' fill='%230ea5e9'/%3E%3Cpath d='M48 128h96M48 96h96M48 64h96' stroke='white' stroke-width='16' stroke-linecap='round'/%3E%3C/svg%3E" />
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 96 96'%3E%3Crect width='96' height='96' rx='16' fill='%230ea5e9'/%3E%3Cpath d='M24 64h48M24 48h48M24 32h48' stroke='white' stroke-width='8' stroke-linecap='round'/%3E%3C/svg%3E" />
  <link rel="stylesheet" href="assets/styles.css" />
  <!-- CDN libs for MVP: Dexie (IndexedDB), PapaParse (CSV), MiniSearch (fuzzy search) -->
  <script defer src="https://cdn.jsdelivr.net/npm/dexie@3.2.7/dist/dexie.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js"></script>
  </head>
  <body>
    <header class="app-header">
      <h1>Almacén Offline</h1>
      <button id="installBtn" hidden>Instalar app</button>
    </header>
    <main>
      <section class="card">
        <h2>Importar CSV</h2>
        <p>Carga un CSV con columnas mapeables a: matrícula, nombre, stock, precio.</p>
        <div class="row">
          <input type="file" id="csvFile" accept=".csv" />
          <button id="startImport" disabled>Importar</button>
          <button id="cancelImport" class="secondary" hidden>Cancelar</button>
        </div>
        <div id="mapping" class="mapping" hidden>
          <label>Matricula <select id="mapMatricula"></select></label>
          <label>Nombre <select id="mapNombre"></select></label>
          <label>Stock <select id="mapStock"></select></label>
          <label>Precio <select id="mapPrecio"></select></label>
        </div>
        <div id="preview" class="preview" hidden>
          <h3>Vista previa</h3>
          <div class="table-wrap">
            <table id="previewTable"></table>
          </div>
        </div>
        <div id="importStatus" class="muted"></div>
      </section>

      <section class="card">
        <h2>Buscar materiales</h2>
        <input id="searchInput" type="search" placeholder="Buscar por nombre o matrícula..." />
        <div id="resultsCount" class="muted"></div>
        <ul id="results" class="list"></ul>
      </section>
    </main>
    <footer class="app-footer">Hecho con ❤ para el modo offline</footer>

  <script type="module" src="assets/app.js"></script>
  </body>
  </html>
